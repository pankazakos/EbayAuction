<div mat-dialog-title>
  <div id="dialog-title">
    {{ item.data.name }}
  </div>
  <div>
    <button mat-icon-button class="top-close-button" mat-dialog-close>
      <mat-icon aria-label="close icon" fontIcon="close"></mat-icon>
    </button>
  </div>
</div>
<div mat-dialog-content id="dialog-content">
  <div id="item-main-container">
    <div *ngIf="item.isLoading">
      <mat-spinner></mat-spinner>
    </div>

    <div *ngIf="!item.isLoading" id="item-box">
      <div class="item-box-element">
        <div *ngIf="image.isLoading" class="skeleton-image"></div>
        <img
          *ngIf="!image.isLoading"
          class="item-image"
          [src]="image.src"
          alt="item photo"
        />
      </div>

      <div *ngIf="!isItemInactive" class="item-info item-box-element">
        <div *ngIf="!isItemInactive" class="info-pair">
          <div class="info-label">Current price:</div>
          <div class="info-value">${{ item.data.currently }}</div>
        </div>

        <div class="info-pair">
          <div class="info-label">Buy at:</div>
          <div class="info-value">
            {{ item.data.buyPrice ? "$" + item.data.buyPrice : "-" }}
          </div>
        </div>

        <div class="info-pair">
          <div class="info-label">Minimum Bid:</div>
          <div class="info-value">${{ item.data.firstBid }}</div>
        </div>

        <div *ngIf="!isItemInactive" class="info-pair">
          <div class="info-label">Number of bids:</div>
          <div class="info-value">{{ item.data.numBids }}</div>
        </div>

        <div class="info-pair">
          <div class="info-label">Categories:</div>
          <div class="info-value">{{ joinedCategories }}</div>
        </div>

        <div class="info-pair">
          <div class="info-label">Started at:</div>
          <div class="info-value">
            {{ isItemInactive ? "Not published yet" : auctionStarted }}
          </div>
        </div>
        <div class="info-pair">
          <div class="info-label">Ending at:</div>
          <div class="info-value">
            {{ isItemInactive ? "Not published yet" : auctionEnds }}
          </div>
        </div>
        <div *ngIf="!isItemInactive" class="info-pair">
          <div class="info-label">Seller:</div>
          <div class="info-value">
            {{ isOwner() ? "you" : seller.username }}
          </div>
        </div>
      </div>
      <div
        [class]="
          isItemInactive
            ? 'item-box-element-description-short'
            : 'item-box-element-description'
        "
      >
        <div class="description-label">Description</div>
        <div class="description">
          {{ item.data.description }}
        </div>
      </div>
      <div class="item-box-element-description-expand">
        <mat-expansion-panel [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title> Description </mat-panel-title>
          </mat-expansion-panel-header>
          <p>
            {{ item.data.description }}
          </p>
        </mat-expansion-panel>
      </div>
    </div>
  </div>
</div>
<div mat-dialog-actions>
  <button mat-raised-button mat-dialog-close>close</button>
  <div *ngIf="!isItemInactive" class="bid-section">
    <form #bidForm="ngForm" (submit)="placeBid()">
      <div
        class="bid-form"
        [matTooltip]="
          authData?.isLoggedIn == false
            ? 'You must be logged in to bid'
            : isOwner()
            ? 'You cannot bid on your own items'
            : ''
        "
        matTooltipPosition="above"
      >
        <input
          type="number"
          name="amount"
          min="{{
            item.data.numBids > 0
              ? item.data.currently + 1
              : item.data.currently
          }}"
          placeholder="${{
            item.data.numBids > 0
              ? item.data.currently + 1
              : item.data.currently
          }}"
          [disabled]="isOwner() || authData?.isLoggedIn == false"
          ngModel
        />

        <button
          mat-raised-button
          color="accent"
          type="submit"
          [disabled]="isOwner() || authData?.isLoggedIn == false"
        >
          bid
        </button>
      </div>
    </form>
  </div>
</div>
